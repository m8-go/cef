{{ template "header" $ }}

import (
    "fmt"
    "strings"
)

func (cef *CEF) extension() string {
    var extension []string

    {{ range . }}
    {{ if eq .DataType "String" }}
    if {{ .CEFKeyName | renameKeyWord | unexported }} := cef.{{ .CEFKeyName | title | renameKeyWord }}(); {{ .CEFKeyName | renameKeyWord | unexported }} != "" {
        extension = append(extension, fmt.Sprintf("{{ .CEFKeyName | renameKeyWord }}=%v", {{ .CEFKeyName | renameKeyWord | unexported }}))
    }
    {{ else if eq .DataType "IP Address" }}
    if {{ .CEFKeyName | renameKeyWord }} := cef.{{ .CEFKeyName | title | renameKeyWord }}(); len({{ .CEFKeyName | renameKeyWord }}) > 0 {
        extension = append(extension, fmt.Sprintf("{{ .CEFKeyName | renameKeyWord }}=%v", {{ .CEFKeyName | renameKeyWord }}))
    }
    {{ else if eq .DataType "IPv6 address" }}
    if {{ .CEFKeyName | renameKeyWord }} := cef.{{ .CEFKeyName | title | renameKeyWord }}(); len({{ .CEFKeyName | renameKeyWord }}) > 0 {
        extension = append(extension, fmt.Sprintf("{{ .CEFKeyName | renameKeyWord }}=%v", {{ .CEFKeyName | renameKeyWord }}))
    }
    {{ else if eq .DataType "IPv6 Address" }}
    if {{ .CEFKeyName | renameKeyWord }} := cef.{{ .CEFKeyName | title | renameKeyWord }}(); len({{ .CEFKeyName | renameKeyWord }}) > 0 {
        extension = append(extension, fmt.Sprintf("{{ .CEFKeyName | renameKeyWord }}=%v", {{ .CEFKeyName | renameKeyWord }}))
    }
    {{ else if eq .DataType "Floating Point" }}
    if {{ .CEFKeyName | renameKeyWord }} := cef.{{ .CEFKeyName | title | renameKeyWord }}(); {{ .CEFKeyName | renameKeyWord }} != 0 {
        extension = append(extension, fmt.Sprintf("{{ .CEFKeyName | renameKeyWord }}=%v", {{ .CEFKeyName | renameKeyWord }}))
    }
    {{ else if eq .DataType "Long" }}
    if {{ .CEFKeyName | renameKeyWord }} := cef.{{ .CEFKeyName | title | renameKeyWord }}(); {{ .CEFKeyName | renameKeyWord }} != 0 {
        extension = append(extension, fmt.Sprintf("{{ .CEFKeyName | renameKeyWord }}=%v", {{ .CEFKeyName | renameKeyWord }}))
    }
    {{ else if eq .DataType "Integer" }}
    if {{ .CEFKeyName | renameKeyWord }} := cef.{{ .CEFKeyName | title | renameKeyWord }}(); {{ .CEFKeyName | renameKeyWord }} != 0 {
        extension = append(extension, fmt.Sprintf("{{ .CEFKeyName | renameKeyWord }}=%v", {{ .CEFKeyName | renameKeyWord }}))
    }
    {{ else if eq .DataType "Time Stamp" }}
    if {{ .CEFKeyName | renameKeyWord }} := cef.{{ .CEFKeyName | title | renameKeyWord }}(); {{ .CEFKeyName | renameKeyWord }} != "" {
        extension = append(extension, fmt.Sprintf("{{ .CEFKeyName | renameKeyWord }}=%v", {{ .CEFKeyName | renameKeyWord }}))
    }
    {{ else if eq .DataType "MAC Address" }}
    if {{ .CEFKeyName | renameKeyWord }} := cef.{{ .CEFKeyName | title | renameKeyWord }}(); len({{ .CEFKeyName | renameKeyWord }}) > 0 {
        extension = append(extension, fmt.Sprintf("{{ .CEFKeyName | renameKeyWord }}=%v", {{ .CEFKeyName | renameKeyWord }}))
    }
    {{ else if eq .DataType "Double" }}
    if {{ .CEFKeyName | renameKeyWord }} := cef.{{ .CEFKeyName | title | renameKeyWord }}(); {{ .CEFKeyName | renameKeyWord }} != 0 {
        extension = append(extension, fmt.Sprintf("{{ .CEFKeyName | renameKeyWord }}=%v", {{ .CEFKeyName | renameKeyWord }}))
    }
    {{ else }}
    if {{ .CEFKeyName | renameKeyWord }} := cef.{{ .CEFKeyName | title | renameKeyWord }}(); {{ .CEFKeyName | renameKeyWord }} != "" {
        extension = append(extension, fmt.Sprintf("{{ .CEFKeyName | renameKeyWord }}=%v", {{ .CEFKeyName | renameKeyWord }}))
    }
    {{ end }}

    {{ end }}

    return strings.Join(extension, " ")
}
