{{ template "header" $ }}

import (
	"net"
	"strconv"
)

func (cef *CEF) set(key string, val string) error {
    switch key {
{{- range .ExtensionFields }}
    case "{{ .CEFKeyName }}":
    {{- if eq .DataType "String" }}
    cef.Set{{ .CEFKeyName | trimAllSpaces | title }}(val)
    {{ else if eq .DataType "IP Address" }}
    cef.Set{{ .CEFKeyName | trimAllSpaces | title }}(net.ParseIP(val))
    {{ else if eq .DataType "IPv6 address" }}
    cef.Set{{ .CEFKeyName | trimAllSpaces | title }}(net.ParseIP(val))
    {{ else if eq .DataType "IPv6 Address" }}
    cef.Set{{ .CEFKeyName | trimAllSpaces | title }}(net.ParseIP(val))
    {{ else if eq .DataType "Floating Point" }}
    {{ .CEFKeyName | trimAllSpaces }}, err := strconv.ParseFloat(val, 32)
    if err != nil {
        return err
    }

    cef.Set{{ .CEFKeyName | trimAllSpaces | title }}(float32({{ .CEFKeyName | trimAllSpaces }}))
    {{ else if eq .DataType "Long" }}
    {{ .CEFKeyName | trimAllSpaces }}, err := strconv.ParseInt(val, 10, 64)
    if err != nil {
        return err
    }

    cef.Set{{ .CEFKeyName | trimAllSpaces | title }}({{ .CEFKeyName | trimAllSpaces }})
    {{ else if eq .DataType "Integer" }}
    {{ .CEFKeyName | trimAllSpaces | renameKeyWord }}, err := strconv.Atoi(val)
    if err != nil {
        return err
    }

    cef.Set{{ .CEFKeyName | trimAllSpaces | title }}({{ .CEFKeyName | trimAllSpaces | renameKeyWord }})
    {{ else if eq .DataType "Time Stamp" }}
    cef.Set{{ .CEFKeyName | trimAllSpaces | title }}(val)
    {{ else if eq .DataType "MAC Address" }}
    {{ .CEFKeyName | trimAllSpaces }}, err := net.ParseMAC(val)
    if err != nil {
        return err
    }

    cef.Set{{ .CEFKeyName | trimAllSpaces | title }}({{ .CEFKeyName | trimAllSpaces }})
    {{ else if eq .DataType "Double" }}
    {{ .CEFKeyName | trimAllSpaces }}, err := strconv.ParseFloat(val, 64)
    if err != nil {
        return err
    }

    cef.Set{{ .CEFKeyName | trimAllSpaces | title }}({{ .CEFKeyName | trimAllSpaces }})
    {{ end }}
{{- end }}
    default:
    }

    return nil
}
