{{ template "header" $ }}

import "net"

type extensionFields struct{
{{- range . }}
// {{ .Meaning }}
{{ .CEFKeyName | unexported | renameKeyWord }} {{ typeMapping .DataType }}
{{- end }}
}

{{ range . }}
// Set{{ .CEFKeyName | title | pretty }} sets {{ .CEFKeyName | unexported | renameKeyWord | quote }} field.
func (cef *CEF) Set{{ .CEFKeyName | title | pretty }}(v {{ typeMapping .DataType }}) *CEF {
{{- if eq .DataType "String" }}
    if cef.{{ .CEFKeyName | unexported | renameKeyWord }} != "" {
        return cef
    }
{{ else if eq .DataType "IP Address" }}
    if len(cef.{{ .CEFKeyName | unexported | renameKeyWord }}) > 0 {
        return cef
    }
{{ else if eq .DataType "IPv6 address" }}
    if len(cef.{{ .CEFKeyName | unexported | renameKeyWord }}) > 0 {
        return cef
    }
{{ else if eq .DataType "IPv6 Address" }}
    if len(cef.{{ .CEFKeyName | unexported | renameKeyWord }}) > 0 {
        return cef
    }
{{ else if eq .DataType "Floating Point" }}
    if cef.{{ .CEFKeyName | unexported | renameKeyWord }} != 0 {
        return cef
    }
{{ else if eq .DataType "Long" }}
    if cef.{{ .CEFKeyName | unexported | renameKeyWord }} != 0 {
        return cef
    }
{{ else if eq .DataType "Integer" }}
    if cef.{{ .CEFKeyName | unexported | renameKeyWord }} != 0 {
        return cef
    }
{{ else if eq .DataType "Time Stamp" }}
    if cef.{{ .CEFKeyName | unexported | renameKeyWord }} != "" {
        return cef
    }
{{ else if eq .DataType "MAC Address" }}
    if len(cef.{{ .CEFKeyName | unexported | renameKeyWord }}) > 0 {
        return cef
    }
{{ else if eq .DataType "Double" }}
    if cef.{{ .CEFKeyName | unexported | renameKeyWord }} != 0 {
        return cef
    }
{{ else }}
    if cef.{{ .CEFKeyName | unexported | renameKeyWord }} != "" {
        return cef
    }
{{ end }}
{{- if not .Length }}
{{- else if eq .Length "N/A" }}
{{- else if eq .Length "64-bit" }}
{{- else }}
    if len(v) > {{ .Length }} {
        v = v[:{{ .Length }}]
    }
{{ end }}
    cef.{{ .CEFKeyName | unexported | renameKeyWord }} = v

    return cef
}
{{ end }}

{{ range . }}
// {{ .Meaning }}
func (cef *CEF) {{ .CEFKeyName | title | pretty }}() {{ typeMapping .DataType }} {
    return cef.{{ .CEFKeyName | unexported | renameKeyWord }}
}
{{ end }}